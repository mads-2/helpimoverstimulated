<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"/>
<title>Aquarium</title>
<style>
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  overflow: hidden;
}

/* üåä Background */
#aquarium {
  position: relative;
  width: 100vw;
  height: 100vh;
  background: url("../cropped/background.jpg") center/cover no-repeat;
  overflow: hidden;
}

/* ü™∏ Bottom objects */
.bottom-object {
  position: absolute;
  pointer-events: none;
  z-index: 2;
  transform-origin: bottom center;
}

/* üê† Fish */
.fish {
  position: absolute;
  height: 25vh;
  width: auto;
  z-index: 5;
}
.fish.jelly { height: 35vh; }
.fish.left { transform: scaleX(-1); }
</style>
</head>
<body>
<div id="aquarium"></div>

<script>
function rand(min, max){ return Math.random() * (max - min) + min; }

/* === Detect if the device is mobile === */
function isMobileDevice() {
  return (
    /Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent) ||
    (window.innerWidth < 900 && 'ontouchstart' in window)
  );
}

/* === Fixed absolute positions for seaweed/anemone === */
const fixedPositions = {
  leftSeaweed:  { x: 22, yMin: 25, yMax: 38 },
  leftAnemone:  { x: 19, yMin: 5,  yMax: 18 },
  rightSeaweed: { x: 78, yMin: 25, yMax: 38 },
  rightAnemone: { x: 81, yMin: 5,  yMax: 18 }
};

/* === Other objects === */
const baseZones = {
  crab:        { x: 50, yMin: 10, yMax: 25 },
  centerShell: { x: 50, yMin: 2,  yMax: 10 }
};

/* === Place bottom objects === */
async function placeObject(src, zone, sizeVHRange, tiltRange, invertChance=0.5, fixedX=null) {
  return new Promise(resolve=>{
    const aquarium=document.getElementById("aquarium");
    const img=document.createElement("img");
    img.src=src;
    img.classList.add("bottom-object");
    let sizeVH=rand(sizeVHRange[0],sizeVHRange[1]);
    img.style.height=`${sizeVH}vh`;

    img.onload=()=>{
      const rect=aquarium.getBoundingClientRect();
      const pxH=(sizeVH/100)*rect.height;
      const pxW=img.naturalWidth*(pxH/img.naturalHeight);

      const x = rect.width * (fixedX / 100) - pxW / 2;
      const yMin=rect.height*zone.yMin/100;
      const yMax=rect.height*zone.yMax/100;
      const y=rand(yMin,yMax-pxH*0.4);

      img.style.left=`${x}px`;
      img.style.bottom=`${y}px`;

      const tilt=rand(tiltRange[0],tiltRange[1]);
      const invert=Math.random()<invertChance?-1:1;
      img.style.transform=`scaleX(${invert}) rotate(${tilt}deg)`;

      aquarium.appendChild(img);
      resolve();
    };
  });
}

/* === Add bottom objects === */
async function addBottomObjects() {
  const base="../cropped/";
  const mobile=isMobileDevice();

  // üåø Sizes
  const seaweedSize = mobile ? [20,25] : [40,47];
  const anemoneSize = mobile ? [18,23] : [36,43];
  const crabSize = mobile ? [18,22] : [30,35];
  const shellSize = [25,30];

  // üìè Adjust Y positions for mobile
  const yOffset = mobile ? 6 : 0; // lift mobile elements higher

  // üåø Left and right seaweed (fixed)
  await placeObject(
    base+"bottom_seaweed.png",
    fixedPositions.leftSeaweed,
    seaweedSize,
    [-2,2],
    0.5,
    fixedPositions.leftSeaweed.x
  );

  await placeObject(
    base+"bottom_seaweed.png",
    fixedPositions.rightSeaweed,
    seaweedSize,
    [-2,2],
    0.5,
    fixedPositions.rightSeaweed.x
  );

  // ü™∏ Left and right anemone ‚Äî spawn higher on mobile
  await placeObject(
    base+"bottom_anemone.png",
    {
      ...fixedPositions.leftAnemone,
      yMin: fixedPositions.leftAnemone.yMin + yOffset,
      yMax: fixedPositions.leftAnemone.yMax + yOffset
    },
    anemoneSize,
    [-2,2],
    0.5,
    fixedPositions.leftAnemone.x
  );

  await placeObject(
    base+"bottom_anemone.png",
    {
      ...fixedPositions.rightAnemone,
      yMin: fixedPositions.rightAnemone.yMin + yOffset,
      yMax: fixedPositions.rightAnemone.yMax + yOffset
    },
    anemoneSize,
    [-2,2],
    0.5,
    fixedPositions.rightAnemone.x
  );

  // ü¶Ä Crab ‚Äî higher on mobile
  await placeObject(
    base+"bottom_crab.png",
    {
      ...baseZones.crab,
      yMin: baseZones.crab.yMin + (mobile ? 8 : 0),
      yMax: baseZones.crab.yMax + (mobile ? 8 : 0)
    },
    crabSize,
    [0,0],
    0.5,
    baseZones.crab.x
  );

  // üêö Shell ‚Äî higher on mobile
  await placeObject(
    base+"bottom_shell.png",
    {
      ...baseZones.centerShell,
      yMin: baseZones.centerShell.yMin + (mobile ? 8 : 0),
      yMax: baseZones.centerShell.yMax + (mobile ? 8 : 0)
    },
    shellSize,
    [-2,2],
    0.5,
    baseZones.centerShell.x
  );
}

/* === üê† Fish === */
function spawnFish(num=10){
  const aquarium=document.getElementById('aquarium');
  const width=aquarium.clientWidth;
  const height=aquarium.clientHeight*0.75;
  const fishImages=[
    "../cropped/fish_blue_beta.png",
    "../cropped/fish_red_beta.png",
    "../cropped/fish_clown.png",
    "../cropped/fish_goldfish.png",
    "../cropped/fish_yellow_tang.png",
    "../cropped/fish_seahorse.png",
    "../cropped/fish_jelly.png"
  ];

  for(let i=0;i<num;i++){
    const img=document.createElement("img");
    const src=fishImages[i%fishImages.length];
    img.src=src;
    img.classList.add("fish");

    // üê† Slightly smaller fish on mobile
    if (isMobileDevice()) {
      const baseH = src.includes("fish_jelly") ? 35 : 25;
      img.style.height = `${baseH * 0.8}vh`;
    } else {
      if(src.includes("fish_jelly")) img.classList.add("jelly");
    }

    const x=rand(0,width-200);
    const y=rand(0,height-150);
    img.style.left=`${x}px`;
    img.style.top=`${y}px`;

    if(Math.random()<0.5) img.classList.add("left");
    aquarium.appendChild(img);
  }
}

/* === Initialize === */
(async()=>{
  await addBottomObjects();
  spawnFish();
})();
</script>
</body>
</html>

